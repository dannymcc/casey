{% extends "base.html" %}

{% block title %}Verify 2FA - Casey{% endblock %}

{% block content %}
<div style="max-width: 360px; margin: 3rem auto;">
    <div class="card" style="text-align: center;">
        <h2>Two-Factor Authentication</h2>
        <p style="font-size: 13px; color: var(--text-secondary); margin-bottom: 1.5rem;">
            Enter the 6-digit code from your authenticator app
        </p>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="flash flash-{{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <form method="POST" action="/verify-2fa">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <div class="form-group">
                <input type="text" name="code" placeholder="000000" required
                       autocomplete="one-time-code" inputmode="numeric" pattern="[0-9]*"
                       maxlength="6" autofocus
                       style="text-align: center; font-size: 1.5rem; letter-spacing: 0.3em; font-family: var(--mono);">
            </div>
            <button type="submit" style="width: 100%;">Verify</button>
        </form>

        <div style="margin-top: 1rem;">
            <a href="/login" style="font-size: 12px; color: var(--text-muted); text-decoration: none;">Back to login</a>
        </div>
    </div>
</div>
{% endblock %}
