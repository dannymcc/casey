{% extends "base.html" %}

{% block title %}Today - Casey{% endblock %}

{% block content %}
<div class="date-header">
    {{ today | uk_date_long }}
</div>

<div class="grid-2">
    <div>
        <!-- Journal Entry -->
        <div class="card">
            <h2>Journal</h2>
            <form method="POST" action="/journal/save">
                <textarea name="content" rows="12" placeholder="What's on your mind today?">{{ journal.content if journal else '' }}</textarea>
                <div class="btn-group">
                    <button type="submit">Save Entry</button>
                </div>
            </form>
        </div>
        
        <!-- Today's Blips -->
        <div class="card">
            <h2>Blips</h2>
            <p style="color: var(--text-muted); font-size: 13px; margin-bottom: 1.25rem;">
                Random thoughts surfaced to spark new ideas
            </p>
            
            {% if blips %}
                {% for blip in blips %}
                    <div class="blip">
                        {{ blip.content }}
                        <div class="blip-meta">
                            Surfaced {{ blip.surface_count }}× • {{ blip.created_at | uk_date }}
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <div class="empty-state">
                    No blips yet. <a href="/blips">Add some</a> to get started.
                </div>
            {% endif %}
        </div>
    </div>
    
    <div>
        <!-- Tasks -->
        <div class="card">
            <h2>Tasks</h2>
            
            <form method="POST" action="/tasks/add" style="margin-bottom: 1.5rem;">
                <input type="text" name="title" placeholder="Add a task..." required>
                <button type="submit" style="margin-top: 0.75rem; width: 100%;">Add Task</button>
            </form>
            
            {% if tasks %}
                <ul class="task-list">
                    {% for task in tasks %}
                        <li class="task-item {{ 'completed' if task.completed else '' }}">
                            <form method="POST" action="/tasks/{{ task.id }}/toggle" style="display: flex; align-items: center; flex: 1;">
                                <input type="checkbox" 
                                       {{ 'checked' if task.completed else '' }}
                                       onchange="this.form.submit()">
                                <span style="flex: 1;">{{ task.title }}</span>
                            </form>
                            <form method="POST" action="/tasks/{{ task.id }}/delete" style="margin-left: 0.5rem;">
                                <button type="submit" class="btn-ghost btn-danger" style="padding: 0.375rem 0.625rem; font-size: 13px;">×</button>
                            </form>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <div class="empty-state">
                    No active tasks
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
