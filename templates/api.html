{% extends "base.html" %}

{% block title %}API - Casey{% endblock %}

{% block extra_styles %}
.api-section {
    background: var(--surface-hover);
    border-radius: var(--radius-sm);
    padding: 1.25rem;
    margin-bottom: 0.75rem;
}

.api-section h4 {
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: 1rem;
    color: var(--ink);
}

.endpoint {
    margin-bottom: 1rem;
}

.endpoint:last-child { margin-bottom: 0; }

.method {
    display: inline-block;
    padding: 0.125rem 0.4375rem;
    border-radius: 4px;
    font-size: 10px;
    font-weight: 600;
    font-family: var(--font);
    color: white;
    letter-spacing: 0.03em;
    text-transform: uppercase;
}

.method-get { background: var(--success); }
.method-post { background: var(--ink); }
.method-put { background: var(--clay); }
.method-delete { background: var(--danger); }

.api-code {
    font-family: var(--mono);
    font-size: 12px;
    color: var(--ink);
    margin-left: 0.5rem;
}

.api-desc {
    color: var(--ink-secondary);
    font-size: 13px;
    margin-top: 0.25rem;
    margin-left: 3rem;
}

.api-param {
    font-size: 12px;
    color: var(--ink-muted);
    margin-top: 0.125rem;
    margin-left: 3rem;
}

pre.code-block {
    background: var(--surface-inset);
    padding: 0.75rem 1rem;
    border-radius: var(--radius-sm);
    overflow-x: auto;
    font-family: var(--mono);
    font-size: 12px;
    color: var(--ink);
    line-height: 1.7;
    border: 1px solid var(--border-light);
}

.api-callout {
    background: var(--clay-subtle);
    border-radius: var(--radius-sm);
    padding: 0.875rem 1.125rem;
    margin-bottom: 2rem;
}

.api-callout-title {
    font-weight: 600;
    font-size: 13px;
    margin-bottom: 0.25rem;
}

.api-callout-text {
    font-size: 13px;
    color: var(--ink-secondary);
}

.api-callout-text a {
    color: var(--clay);
    text-decoration: none;
    font-weight: 500;
}

.api-callout-text a:hover { text-decoration: underline; }
{% endblock %}

{% block content %}
<div style="max-width: 700px;">
    <h1 class="page-title">API</h1>
    <p class="page-desc" style="margin-bottom: 1.5rem; line-height: 1.7;">
        Access your data programmatically, build integrations, or automate workflows.
    </p>

    <div class="card">
        <div class="api-callout">
            <div class="api-callout-title">API Key Required</div>
            <div class="api-callout-text">
                All requests require <code style="font-family: var(--mono); font-size: 11px; background: var(--surface); padding: 0.125rem 0.375rem; border-radius: 3px;">X-API-Key</code> header.
                <a href="/settings/api">View your key &rsaquo;</a>
            </div>
        </div>

        <h3 style="font-size: 0.875rem; font-weight: 600; margin-bottom: 0.5rem;">Base URL</h3>
        <pre class="code-block" style="margin-bottom: 2rem;">https://casey.dmcc.io/api</pre>

        <h3 style="font-size: 0.875rem; font-weight: 600; margin-bottom: 0.5rem;">Authentication</h3>
        <p style="color: var(--ink-secondary); font-size: 13px; margin-bottom: 0.5rem;">Include your API key in every request:</p>
        <pre class="code-block" style="margin-bottom: 2rem;">curl -H "X-API-Key: YOUR_API_KEY" https://casey.dmcc.io/api/tasks</pre>

        <h3 style="font-size: 0.875rem; font-weight: 600; margin-bottom: 1rem;">Endpoints</h3>

        <div class="api-section">
            <h4>Journal Entries</h4>

            <div class="endpoint">
                <span class="method method-get">GET</span>
                <code class="api-code">/api/journal</code>
                <div class="api-desc">Get recent journal entries (default: 30)</div>
                <div class="api-param">Query: <code style="font-family: var(--mono); font-size: 11px;">?limit=10</code></div>
            </div>

            <div class="endpoint">
                <span class="method method-get">GET</span>
                <code class="api-code">/api/journal/2026-02-09</code>
                <div class="api-desc">Get journal entry for a specific date</div>
            </div>

            <div class="endpoint">
                <span class="method method-post">POST</span>
                <code class="api-code">/api/journal/2026-02-09</code>
                <div class="api-desc">Create or update journal entry</div>
                <pre class="code-block" style="margin-top: 0.375rem; margin-left: 3rem;">{"content": "Today was productive..."}</pre>
            </div>
        </div>

        <div class="api-section">
            <h4>Tasks</h4>

            <div class="endpoint">
                <span class="method method-get">GET</span>
                <code class="api-code">/api/tasks</code>
                <div class="api-desc">Get all tasks</div>
                <div class="api-param">Query: <code style="font-family: var(--mono); font-size: 11px;">?completed=0</code> (0 or 1)</div>
            </div>

            <div class="endpoint">
                <span class="method method-post">POST</span>
                <code class="api-code">/api/tasks</code>
                <div class="api-desc">Create a new task</div>
                <pre class="code-block" style="margin-top: 0.375rem; margin-left: 3rem;">{"title": "Finish the report"}</pre>
            </div>

            <div class="endpoint">
                <span class="method method-get">GET</span>
                <code class="api-code">/api/tasks/:id</code>
                <div class="api-desc">Get a specific task</div>
            </div>

            <div class="endpoint">
                <span class="method method-put">PUT</span>
                <code class="api-code">/api/tasks/:id</code>
                <div class="api-desc">Update a task</div>
                <pre class="code-block" style="margin-top: 0.375rem; margin-left: 3rem;">{"completed": 1}</pre>
            </div>

            <div class="endpoint">
                <span class="method method-delete">DELETE</span>
                <code class="api-code">/api/tasks/:id</code>
                <div class="api-desc">Delete a task</div>
            </div>
        </div>

        <div class="api-section">
            <h4>Blips</h4>

            <div class="endpoint">
                <span class="method method-get">GET</span>
                <code class="api-code">/api/blips</code>
                <div class="api-desc">Get all blips</div>
            </div>

            <div class="endpoint">
                <span class="method method-post">POST</span>
                <code class="api-code">/api/blips</code>
                <div class="api-desc">Create a new blip</div>
                <pre class="code-block" style="margin-top: 0.375rem; margin-left: 3rem;">{"content": "Quick idea: integrate with Notion"}</pre>
            </div>

            <div class="endpoint">
                <span class="method method-get">GET</span>
                <code class="api-code">/api/blips/:id</code>
                <div class="api-desc">Get a specific blip</div>
            </div>

            <div class="endpoint">
                <span class="method method-delete">DELETE</span>
                <code class="api-code">/api/blips/:id</code>
                <div class="api-desc">Delete a blip</div>
            </div>
        </div>

        <h3 style="font-size: 0.875rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem;">Response Format</h3>
        <p style="color: var(--ink-secondary); font-size: 13px; margin-bottom: 0.5rem;">
            All responses are JSON. Errors return appropriate status codes:
        </p>
        <pre class="code-block" style="margin-bottom: 2rem;">{"error": "Invalid or missing API key"}</pre>

        <h3 style="font-size: 0.875rem; font-weight: 600; margin-bottom: 0.5rem;">Example</h3>
        <pre class="code-block">curl -X POST \
  -H "X-API-Key: YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{"title":"Review API documentation"}' \
  https://casey.dmcc.io/api/tasks</pre>
    </div>
</div>
{% endblock %}
